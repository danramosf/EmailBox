<!DOCTYPE html>
<html>
<head>
  <title>README.md</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules\\busboy\\README.md";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#description">Description</a>
      </div>

      <div class="heading h1">
        <a href="#requirements">Requirements</a>
      </div>

      <div class="heading h1">
        <a href="#install">Install</a>
      </div>

      <div class="heading h1">
        <a href="#examples">Examples</a>
      </div>

      <div class="heading h1">
        <a href="#api">API</a>
      </div>

      <div class="heading h2">
        <a href="#busboy-special-events">Busboy (special) events</a>
      </div>

      <div class="heading h2">
        <a href="#busboy-methods">Busboy methods</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="docs markdown"><div class="pilwrap" id="description">
  <h1>
    <a href="#description" name="description" class="pilcrow"></a>
Description
  </h1>
</div>
<p>A node.js module for parsing incoming HTML form data.</p>
<p>If you've found this module to be useful and wish to support it, you may do so by visiting this pledgie campaign:
<a href='https://pledgie.com/campaigns/28774'><img alt='Click here to support busboy' src='https://pledgie.com/campaigns/28774.png?skin_name=chrome' border='0'></a></p>
<div class="pilwrap" id="requirements">
  <h1>
    <a href="#requirements" name="requirements" class="pilcrow"></a>
Requirements
  </h1>
</div>
<ul>
<li><a href="http://nodejs.org/">node.js</a> -- v0.8.0 or newer</li>
</ul>
<div class="pilwrap" id="install">
  <h1>
    <a href="#install" name="install" class="pilcrow"></a>
Install
  </h1>
</div>
<pre><code>npm install busboy
</code></pre>
<div class="pilwrap" id="examples">
  <h1>
    <a href="#examples" name="examples" class="pilcrow"></a>
Examples
  </h1>
</div>
<ul>
<li>Parsing (multipart) with default options:</li>
</ul>
<pre><code class="javascript"><span class="hljs-keyword">var</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>),
    inspect = <span class="hljs-built_in">require</span>(<span class="hljs-string">'util'</span>).inspect;

<span class="hljs-keyword">var</span> Busboy = <span class="hljs-built_in">require</span>(<span class="hljs-string">'busboy'</span>);

http.createServer(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>{
  <span class="hljs-keyword">if</span> (req.method === <span class="hljs-string">'POST'</span>) {
    <span class="hljs-keyword">var</span> busboy = <span class="hljs-keyword">new</span> Busboy({ <span class="hljs-attr">headers</span>: req.headers });
    busboy.on(<span class="hljs-string">'file'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldname, file, filename, encoding, mimetype</span>) </span>{
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'File ['</span> + fieldname + <span class="hljs-string">']: filename: '</span> + filename + <span class="hljs-string">', encoding: '</span> + encoding + <span class="hljs-string">', mimetype: '</span> + mimetype);
      file.on(<span class="hljs-string">'data'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) </span>{
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'File ['</span> + fieldname + <span class="hljs-string">'] got '</span> + data.length + <span class="hljs-string">' bytes'</span>);
      });
      file.on(<span class="hljs-string">'end'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'File ['</span> + fieldname + <span class="hljs-string">'] Finished'</span>);
      });
    });
    busboy.on(<span class="hljs-string">'field'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldname, val, fieldnameTruncated, valTruncated, encoding, mimetype</span>) </span>{
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Field ['</span> + fieldname + <span class="hljs-string">']: value: '</span> + inspect(val));
    });
    busboy.on(<span class="hljs-string">'finish'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Done parsing form!'</span>);
      res.writeHead(<span class="hljs-number">303</span>, { <span class="hljs-attr">Connection</span>: <span class="hljs-string">'close'</span>, <span class="hljs-attr">Location</span>: <span class="hljs-string">'/'</span> });
      res.end();
    });
    req.pipe(busboy);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (req.method === <span class="hljs-string">'GET'</span>) {
    res.writeHead(<span class="hljs-number">200</span>, { <span class="hljs-attr">Connection</span>: <span class="hljs-string">'close'</span> });
    res.end(<span class="hljs-string">'&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;\
               &lt;form method="POST" enctype="multipart/form-data"&gt;\
                &lt;input type="text" name="textfield"&gt;&lt;br /&gt;\
                &lt;input type="file" name="filefield"&gt;&lt;br /&gt;\
                &lt;input type="submit"&gt;\
              &lt;/form&gt;\
            &lt;/body&gt;&lt;/html&gt;'</span>);
  }
}).listen(<span class="hljs-number">8000</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Listening for requests'</span>);
});

<span class="hljs-comment">// Example output, using http://nodejs.org/images/ryan-speaker.jpg as the file:</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// Listening for requests</span>
<span class="hljs-comment">// File [filefield]: filename: ryan-speaker.jpg, encoding: binary</span>
<span class="hljs-comment">// File [filefield] got 11971 bytes</span>
<span class="hljs-comment">// Field [textfield]: value: 'testing! :-)'</span>
<span class="hljs-comment">// File [filefield] Finished</span>
<span class="hljs-comment">// Done parsing form!</span>
</code></pre>
<ul>
<li>Save all incoming files to disk:</li>
</ul>
<pre><code class="javascript"><span class="hljs-keyword">var</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>),
    path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>),
    os = <span class="hljs-built_in">require</span>(<span class="hljs-string">'os'</span>),
    fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);

<span class="hljs-keyword">var</span> Busboy = <span class="hljs-built_in">require</span>(<span class="hljs-string">'busboy'</span>);

http.createServer(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>{
  <span class="hljs-keyword">if</span> (req.method === <span class="hljs-string">'POST'</span>) {
    <span class="hljs-keyword">var</span> busboy = <span class="hljs-keyword">new</span> Busboy({ <span class="hljs-attr">headers</span>: req.headers });
    busboy.on(<span class="hljs-string">'file'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldname, file, filename, encoding, mimetype</span>) </span>{
      <span class="hljs-keyword">var</span> saveTo = path.join(os.tmpDir(), path.basename(fieldname));
      file.pipe(fs.createWriteStream(saveTo));
    });
    busboy.on(<span class="hljs-string">'finish'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      res.writeHead(<span class="hljs-number">200</span>, { <span class="hljs-string">'Connection'</span>: <span class="hljs-string">'close'</span> });
      res.end(<span class="hljs-string">"That's all folks!"</span>);
    });
    <span class="hljs-keyword">return</span> req.pipe(busboy);
  }
  res.writeHead(<span class="hljs-number">404</span>);
  res.end();
}).listen(<span class="hljs-number">8000</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Listening for requests'</span>);
});
</code></pre>
<ul>
<li>Parsing (urlencoded) with default options:</li>
</ul>
<pre><code class="javascript"><span class="hljs-keyword">var</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>),
    inspect = <span class="hljs-built_in">require</span>(<span class="hljs-string">'util'</span>).inspect;

<span class="hljs-keyword">var</span> Busboy = <span class="hljs-built_in">require</span>(<span class="hljs-string">'busboy'</span>);

http.createServer(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>{
  <span class="hljs-keyword">if</span> (req.method === <span class="hljs-string">'POST'</span>) {
    <span class="hljs-keyword">var</span> busboy = <span class="hljs-keyword">new</span> Busboy({ <span class="hljs-attr">headers</span>: req.headers });
    busboy.on(<span class="hljs-string">'file'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldname, file, filename, encoding, mimetype</span>) </span>{
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'File ['</span> + fieldname + <span class="hljs-string">']: filename: '</span> + filename);
      file.on(<span class="hljs-string">'data'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) </span>{
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'File ['</span> + fieldname + <span class="hljs-string">'] got '</span> + data.length + <span class="hljs-string">' bytes'</span>);
      });
      file.on(<span class="hljs-string">'end'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'File ['</span> + fieldname + <span class="hljs-string">'] Finished'</span>);
      });
    });
    busboy.on(<span class="hljs-string">'field'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldname, val, fieldnameTruncated, valTruncated</span>) </span>{
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Field ['</span> + fieldname + <span class="hljs-string">']: value: '</span> + inspect(val));
    });
    busboy.on(<span class="hljs-string">'finish'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Done parsing form!'</span>);
      res.writeHead(<span class="hljs-number">303</span>, { <span class="hljs-attr">Connection</span>: <span class="hljs-string">'close'</span>, <span class="hljs-attr">Location</span>: <span class="hljs-string">'/'</span> });
      res.end();
    });
    req.pipe(busboy);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (req.method === <span class="hljs-string">'GET'</span>) {
    res.writeHead(<span class="hljs-number">200</span>, { <span class="hljs-attr">Connection</span>: <span class="hljs-string">'close'</span> });
    res.end(<span class="hljs-string">'&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;\
               &lt;form method="POST"&gt;\
                &lt;input type="text" name="textfield"&gt;&lt;br /&gt;\
                &lt;select name="selectfield"&gt;\
                  &lt;option value="1"&gt;1&lt;/option&gt;\
                  &lt;option value="10"&gt;10&lt;/option&gt;\
                  &lt;option value="100"&gt;100&lt;/option&gt;\
                  &lt;option value="9001"&gt;9001&lt;/option&gt;\
                &lt;/select&gt;&lt;br /&gt;\
                &lt;input type="checkbox" name="checkfield"&gt;Node.js rules!&lt;br /&gt;\
                &lt;input type="submit"&gt;\
              &lt;/form&gt;\
            &lt;/body&gt;&lt;/html&gt;'</span>);
  }
}).listen(<span class="hljs-number">8000</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Listening for requests'</span>);
});

<span class="hljs-comment">// Example output:</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// Listening for requests</span>
<span class="hljs-comment">// Field [textfield]: value: 'testing! :-)'</span>
<span class="hljs-comment">// Field [selectfield]: value: '9001'</span>
<span class="hljs-comment">// Field [checkfield]: value: 'on'</span>
<span class="hljs-comment">// Done parsing form!</span>
</code></pre>
<div class="pilwrap" id="api">
  <h1>
    <a href="#api" name="api" class="pilcrow"></a>
API
  </h1>
</div>
<p><em>Busboy</em> is a <em>Writable</em> stream</p>
<div class="pilwrap" id="busboy-special-events">
  <h2>
    <a href="#busboy-special-events" name="busboy-special-events" class="pilcrow"></a>
Busboy (special) events
  </h2>
</div>
<ul>
<li>
<p><strong>file</strong>(&lt; <em>string</em> &gt;fieldname, &lt; <em>ReadableStream</em> &gt;stream, &lt; <em>string</em> &gt;filename, &lt; <em>string</em> &gt;transferEncoding, &lt; <em>string</em> &gt;mimeType) - Emitted for each new file form field found. <code>transferEncoding</code> contains the 'Content-Transfer-Encoding' value for the file stream. <code>mimeType</code> contains the 'Content-Type' value for the file stream.</p>
<ul>
<li>Note: if you listen for this event, you should always handle the <code>stream</code> no matter if you care about the file contents or not (e.g. you can simply just do <code>stream.resume();</code> if you want to discard the contents), otherwise the 'finish' event will never fire on the Busboy instance. However, if you don't care about <strong>any</strong> incoming files, you can simply not listen for the 'file' event at all and any/all files will be automatically and safely discarded (these discarded files do still count towards <code>files</code> and <code>parts</code> limits).</li>
<li>If a configured file size limit was reached, <code>stream</code> will both have a boolean property <code>truncated</code> (best checked at the end of the stream) and emit a 'limit' event to notify you when this happens.</li>
</ul>
</li>
<li>
<p><strong>field</strong>(&lt; <em>string</em> &gt;fieldname, &lt; <em>string</em> &gt;value, &lt; <em>boolean</em> &gt;fieldnameTruncated, &lt; <em>boolean</em> &gt;valueTruncated, &lt; <em>string</em> &gt;transferEncoding, &lt; <em>string</em> &gt;mimeType) - Emitted for each new non-file field found.</p>
</li>
<li>
<p><strong>partsLimit</strong>() - Emitted when specified <code>parts</code> limit has been reached. No more 'file' or 'field' events will be emitted.</p>
</li>
<li>
<p><strong>filesLimit</strong>() - Emitted when specified <code>files</code> limit has been reached. No more 'file' events will be emitted.</p>
</li>
<li>
<p><strong>fieldsLimit</strong>() - Emitted when specified <code>fields</code> limit has been reached. No more 'field' events will be emitted.</p>
</li>
</ul>
<div class="pilwrap" id="busboy-methods">
  <h2>
    <a href="#busboy-methods" name="busboy-methods" class="pilcrow"></a>
Busboy methods
  </h2>
</div>
<ul>
<li>
<p><strong>(constructor)</strong>(&lt; <em>object</em> &gt;config) - Creates and returns a new Busboy instance.</p>
<ul>
<li>
<p>The constructor takes the following valid <code>config</code> settings:</p>
<ul>
<li>
<p><strong>headers</strong> - <em>object</em> - These are the HTTP headers of the incoming request, which are used by individual parsers.</p>
</li>
<li>
<p><strong>highWaterMark</strong> - <em>integer</em> - highWaterMark to use for this Busboy instance (Default: WritableStream default).</p>
</li>
<li>
<p><strong>fileHwm</strong> - <em>integer</em> - highWaterMark to use for file streams (Default: ReadableStream default).</p>
</li>
<li>
<p><strong>defCharset</strong> - <em>string</em> - Default character set to use when one isn't defined (Default: 'utf8').</p>
</li>
<li>
<p><strong>preservePath</strong> - <em>boolean</em> - If paths in the multipart 'filename' field shall be preserved. (Default: false).</p>
</li>
<li>
<p><strong>limits</strong> - <em>object</em> - Various limits on incoming data. Valid properties are:</p>
<ul>
<li>
<p><strong>fieldNameSize</strong> - <em>integer</em> - Max field name size (in bytes) (Default: 100 bytes).</p>
</li>
<li>
<p><strong>fieldSize</strong> - <em>integer</em> - Max field value size (in bytes) (Default: 1MB).</p>
</li>
<li>
<p><strong>fields</strong> - <em>integer</em> - Max number of non-file fields (Default: Infinity).</p>
</li>
<li>
<p><strong>fileSize</strong> - <em>integer</em> - For multipart forms, the max file size (in bytes) (Default: Infinity).</p>
</li>
<li>
<p><strong>files</strong> - <em>integer</em> - For multipart forms, the max number of file fields (Default: Infinity).</p>
</li>
<li>
<p><strong>parts</strong> - <em>integer</em> - For multipart forms, the max number of parts (fields + files) (Default: Infinity).</p>
</li>
<li>
<p><strong>headerPairs</strong> - <em>integer</em> - For multipart forms, the max number of header key=&gt;value pairs to parse <strong>Default:</strong> 2000 (same as node's http).</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>The constructor can throw errors:</p>
<ul>
<li>
<p><strong>Unsupported content type: $type</strong> - The <code>Content-Type</code> isn't one Busboy can parse.</p>
</li>
<li>
<p><strong>Missing Content-Type</strong> - The provided headers don't include <code>Content-Type</code> at all.</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
  </div>
</body>
</html>
