<!DOCTYPE html>
<html>
<head>
  <title>README.md</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules\\cors\\README.md";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#cors">cors</a>
      </div>

      <div class="heading h2">
        <a href="#installation">Installation</a>
      </div>

      <div class="heading h2">
        <a href="#usage">Usage</a>
      </div>

      <div class="heading h3">
        <a href="#simple-usage-enable-all-cors-requests">Simple Usage (Enable All CORS Requests)</a>
      </div>

      <div class="heading h3">
        <a href="#enable-cors-for-a-single-route">Enable CORS for a Single Route</a>
      </div>

      <div class="heading h3">
        <a href="#configuring-cors">Configuring CORS</a>
      </div>

      <div class="heading h3">
        <a href="#configuring-cors-w-dynamic-origin">Configuring CORS w/ Dynamic Origin</a>
      </div>

      <div class="heading h3">
        <a href="#enabling-cors-pre-flight">Enabling CORS Pre-Flight</a>
      </div>

      <div class="heading h3">
        <a href="#configuring-cors-asynchronously">Configuring CORS Asynchronously</a>
      </div>

      <div class="heading h2">
        <a href="#configuration-options">Configuration Options</a>
      </div>

      <div class="heading h2">
        <a href="#demo">Demo</a>
      </div>

      <div class="heading h2">
        <a href="#license">License</a>
      </div>

      <div class="heading h2">
        <a href="#author">Author</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="docs markdown"><div class="pilwrap" id="cors">
  <h1>
    <a href="#cors" name="cors" class="pilcrow"></a>
cors
  </h1>
</div>
<p><a href="https://npmjs.org/package/cors"><img src="https://img.shields.io/npm/v/cors.svg" alt="NPM Version"></a>
<a href="https://npmjs.org/package/cors"><img src="https://img.shields.io/npm/dm/cors.svg" alt="NPM Downloads"></a>
<a href="https://travis-ci.org/expressjs/cors"><img src="https://img.shields.io/travis/expressjs/cors/master.svg" alt="Build Status"></a>
<a href="https://coveralls.io/r/expressjs/cors?branch=master"><img src="https://img.shields.io/coveralls/expressjs/cors/master.svg" alt="Test Coverage"></a></p>
<p>CORS is a node.js package for providing a <a href="http://www.senchalabs.org/connect/">Connect</a>/<a href="http://expressjs.com/">Express</a> middleware that can be used to enable <a href="http://en.wikipedia.org/wiki/Cross-origin_resource_sharing">CORS</a> with various options.</p>
<p><strong><a href="https://twitter.com/intent/user?screen_name=troygoode">Follow me (@troygoode) on Twitter!</a></strong></p>
<ul>
<li><a href="#installation.html">Installation</a></li>
<li><a href="#usage.html">Usage</a>
<ul>
<li><a href="#simple-usage-enable-all-cors-requests.html">Simple Usage</a></li>
<li><a href="#enable-cors-for-a-single-route.html">Enable CORS for a Single Route</a></li>
<li><a href="#configuring-cors.html">Configuring CORS</a></li>
<li><a href="#configuring-cors-asynchronously.html">Configuring CORS Asynchronously</a></li>
<li><a href="#enabling-cors-pre-flight.html">Enabling CORS Pre-Flight</a></li>
</ul>
</li>
<li><a href="#configuration-options.html">Configuration Options</a></li>
<li><a href="#demo.html">Demo</a></li>
<li><a href="#license.html">License</a></li>
<li><a href="#author.html">Author</a></li>
</ul>
<div class="pilwrap" id="installation">
  <h2>
    <a href="#installation" name="installation" class="pilcrow"></a>
Installation
  </h2>
</div>
<p>This is a <a href="https://nodejs.org/en/">Node.js</a> module available through the
<a href="https://www.npmjs.com/">npm registry</a>. Installation is done using the
<a href="https://docs.npmjs.com/getting-started/installing-npm-packages-locally"><code>npm install</code> command</a>:</p>
<pre><code class="sh">$ npm install cors
</code></pre>
<div class="pilwrap" id="usage">
  <h2>
    <a href="#usage" name="usage" class="pilcrow"></a>
Usage
  </h2>
</div>
<div class="pilwrap" id="simple-usage-enable-all-cors-requests">
  <h3>
    <a href="#simple-usage-enable-all-cors-requests" name="simple-usage-enable-all-cors-requests" class="pilcrow"></a>
Simple Usage (Enable <em>All</em> CORS Requests)
  </h3>
</div>
<pre><code class="javascript"><span class="hljs-keyword">var</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>)
<span class="hljs-keyword">var</span> cors = <span class="hljs-built_in">require</span>(<span class="hljs-string">'cors'</span>)
<span class="hljs-keyword">var</span> app = express()

app.use(cors())

app.get(<span class="hljs-string">'/products/:id'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res, next</span>) </span>{
  res.json({<span class="hljs-attr">msg</span>: <span class="hljs-string">'This is CORS-enabled for all origins!'</span>})
})

app.listen(<span class="hljs-number">80</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'CORS-enabled web server listening on port 80'</span>)
})
</code></pre>
<div class="pilwrap" id="enable-cors-for-a-single-route">
  <h3>
    <a href="#enable-cors-for-a-single-route" name="enable-cors-for-a-single-route" class="pilcrow"></a>
Enable CORS for a Single Route
  </h3>
</div>
<pre><code class="javascript"><span class="hljs-keyword">var</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>)
<span class="hljs-keyword">var</span> cors = <span class="hljs-built_in">require</span>(<span class="hljs-string">'cors'</span>)
<span class="hljs-keyword">var</span> app = express()

app.get(<span class="hljs-string">'/products/:id'</span>, cors(), <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res, next</span>) </span>{
  res.json({<span class="hljs-attr">msg</span>: <span class="hljs-string">'This is CORS-enabled for a Single Route'</span>})
})

app.listen(<span class="hljs-number">80</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'CORS-enabled web server listening on port 80'</span>)
})
</code></pre>
<div class="pilwrap" id="configuring-cors">
  <h3>
    <a href="#configuring-cors" name="configuring-cors" class="pilcrow"></a>
Configuring CORS
  </h3>
</div>
<pre><code class="javascript"><span class="hljs-keyword">var</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>)
<span class="hljs-keyword">var</span> cors = <span class="hljs-built_in">require</span>(<span class="hljs-string">'cors'</span>)
<span class="hljs-keyword">var</span> app = express()

<span class="hljs-keyword">var</span> corsOptions = {
  <span class="hljs-attr">origin</span>: <span class="hljs-string">'http://example.com'</span>,
  <span class="hljs-attr">optionsSuccessStatus</span>: <span class="hljs-number">200</span> <span class="hljs-comment">// some legacy browsers (IE11, various SmartTVs) choke on 204</span>
}

app.get(<span class="hljs-string">'/products/:id'</span>, cors(corsOptions), <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res, next</span>) </span>{
  res.json({<span class="hljs-attr">msg</span>: <span class="hljs-string">'This is CORS-enabled for only example.com.'</span>})
})

app.listen(<span class="hljs-number">80</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'CORS-enabled web server listening on port 80'</span>)
})
</code></pre>
<div class="pilwrap" id="configuring-cors-w-dynamic-origin">
  <h3>
    <a href="#configuring-cors-w-dynamic-origin" name="configuring-cors-w-dynamic-origin" class="pilcrow"></a>
Configuring CORS w/ Dynamic Origin
  </h3>
</div>
<pre><code class="javascript"><span class="hljs-keyword">var</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>)
<span class="hljs-keyword">var</span> cors = <span class="hljs-built_in">require</span>(<span class="hljs-string">'cors'</span>)
<span class="hljs-keyword">var</span> app = express()

<span class="hljs-keyword">var</span> whitelist = [<span class="hljs-string">'http://example1.com'</span>, <span class="hljs-string">'http://example2.com'</span>]
<span class="hljs-keyword">var</span> corsOptions = {
  <span class="hljs-attr">origin</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">origin, callback</span>) </span>{
    <span class="hljs-keyword">if</span> (whitelist.indexOf(origin) !== <span class="hljs-number">-1</span>) {
      callback(<span class="hljs-literal">null</span>, <span class="hljs-literal">true</span>)
    } <span class="hljs-keyword">else</span> {
      callback(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Not allowed by CORS'</span>))
    }
  }
}

app.get(<span class="hljs-string">'/products/:id'</span>, cors(corsOptions), <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res, next</span>) </span>{
  res.json({<span class="hljs-attr">msg</span>: <span class="hljs-string">'This is CORS-enabled for a whitelisted domain.'</span>})
})

app.listen(<span class="hljs-number">80</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'CORS-enabled web server listening on port 80'</span>)
})
</code></pre>
<div class="pilwrap" id="enabling-cors-pre-flight">
  <h3>
    <a href="#enabling-cors-pre-flight" name="enabling-cors-pre-flight" class="pilcrow"></a>
Enabling CORS Pre-Flight
  </h3>
</div>
<p>Certain CORS requests are considered 'complex' and require an initial
<code>OPTIONS</code> request (called the &quot;pre-flight request&quot;). An example of a
'complex' CORS request is one that uses an HTTP verb other than
GET/HEAD/POST (such as DELETE) or that uses custom headers. To enable
pre-flighting, you must add a new OPTIONS handler for the route you want
to support:</p>
<pre><code class="javascript"><span class="hljs-keyword">var</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>)
<span class="hljs-keyword">var</span> cors = <span class="hljs-built_in">require</span>(<span class="hljs-string">'cors'</span>)
<span class="hljs-keyword">var</span> app = express()

app.options(<span class="hljs-string">'/products/:id'</span>, cors()) <span class="hljs-comment">// enable pre-flight request for DELETE request</span>
app.del(<span class="hljs-string">'/products/:id'</span>, cors(), <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res, next</span>) </span>{
  res.json({<span class="hljs-attr">msg</span>: <span class="hljs-string">'This is CORS-enabled for all origins!'</span>})
})

app.listen(<span class="hljs-number">80</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'CORS-enabled web server listening on port 80'</span>)
})
</code></pre>
<p>You can also enable pre-flight across-the-board like so:</p>
<pre><code class="javascript">app.options(<span class="hljs-string">'*'</span>, cors()) <span class="hljs-comment">// include before other routes</span>
</code></pre>
<div class="pilwrap" id="configuring-cors-asynchronously">
  <h3>
    <a href="#configuring-cors-asynchronously" name="configuring-cors-asynchronously" class="pilcrow"></a>
Configuring CORS Asynchronously
  </h3>
</div>
<pre><code class="javascript"><span class="hljs-keyword">var</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>)
<span class="hljs-keyword">var</span> cors = <span class="hljs-built_in">require</span>(<span class="hljs-string">'cors'</span>)
<span class="hljs-keyword">var</span> app = express()

<span class="hljs-keyword">var</span> whitelist = [<span class="hljs-string">'http://example1.com'</span>, <span class="hljs-string">'http://example2.com'</span>]
<span class="hljs-keyword">var</span> corsOptionsDelegate = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, callback</span>) </span>{
  <span class="hljs-keyword">var</span> corsOptions;
  <span class="hljs-keyword">if</span> (whitelist.indexOf(req.header(<span class="hljs-string">'Origin'</span>)) !== <span class="hljs-number">-1</span>) {
    corsOptions = { <span class="hljs-attr">origin</span>: <span class="hljs-literal">true</span> } <span class="hljs-comment">// reflect (enable) the requested origin in the CORS response</span>
  }<span class="hljs-keyword">else</span>{
    corsOptions = { <span class="hljs-attr">origin</span>: <span class="hljs-literal">false</span> } <span class="hljs-comment">// disable CORS for this request</span>
  }
  callback(<span class="hljs-literal">null</span>, corsOptions) <span class="hljs-comment">// callback expects two parameters: error and options</span>
}

app.get(<span class="hljs-string">'/products/:id'</span>, cors(corsOptionsDelegate), <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res, next</span>) </span>{
  res.json({<span class="hljs-attr">msg</span>: <span class="hljs-string">'This is CORS-enabled for a whitelisted domain.'</span>})
})

app.listen(<span class="hljs-number">80</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'CORS-enabled web server listening on port 80'</span>)
})
</code></pre>
<div class="pilwrap" id="configuration-options">
  <h2>
    <a href="#configuration-options" name="configuration-options" class="pilcrow"></a>
Configuration Options
  </h2>
</div>
<ul>
<li><code>origin</code>: Configures the <strong>Access-Control-Allow-Origin</strong> CORS header. Possible values:
<ul>
<li><code>Boolean</code> - set <code>origin</code> to <code>true</code> to reflect the <a href="http://tools.ietf.org/html/draft-abarth-origin-09">request origin</a>, as defined by <code>req.header('Origin')</code>, or set it to <code>false</code> to disable CORS.</li>
<li><code>String</code> - set <code>origin</code> to a specific origin. For example if you set it to <code>&quot;http://example.com&quot;</code> only requests from &quot;http://example.com&quot; will be allowed.</li>
<li><code>RegExp</code> - set <code>origin</code> to a regular expression pattern which will be used to test the request origin. If it's a match, the request origin will be reflected. For example the pattern <code>/example\.com$/</code> will reflect any request that is coming from an origin ending with &quot;example.com&quot;.</li>
<li><code>Array</code> - set <code>origin</code> to an array of valid origins. Each origin can be a <code>String</code> or a <code>RegExp</code>. For example <code>[&quot;http://example1.com&quot;, /\.example2\.com$/]</code> will accept any request from &quot;http://example1.com&quot; or from a subdomain of &quot;example2.com&quot;.</li>
<li><code>Function</code> - set <code>origin</code> to a function implementing some custom logic. The function takes the request origin as the first parameter and a callback (which expects the signature <code>err [object], allow [bool]</code>) as the second.</li>
</ul>
</li>
<li><code>methods</code>: Configures the <strong>Access-Control-Allow-Methods</strong> CORS header. Expects a comma-delimited string (ex: 'GET,PUT,POST') or an array (ex: <code>['GET', 'PUT', 'POST']</code>).</li>
<li><code>allowedHeaders</code>: Configures the <strong>Access-Control-Allow-Headers</strong> CORS header. Expects a comma-delimited string (ex: 'Content-Type,Authorization') or an array (ex: <code>['Content-Type', 'Authorization']</code>). If not specified, defaults to reflecting the headers specified in the request's <strong>Access-Control-Request-Headers</strong> header.</li>
<li><code>exposedHeaders</code>: Configures the <strong>Access-Control-Expose-Headers</strong> CORS header. Expects a comma-delimited string (ex: 'Content-Range,X-Content-Range') or an array (ex: <code>['Content-Range', 'X-Content-Range']</code>). If not specified, no custom headers are exposed.</li>
<li><code>credentials</code>: Configures the <strong>Access-Control-Allow-Credentials</strong> CORS header. Set to <code>true</code> to pass the header, otherwise it is omitted.</li>
<li><code>maxAge</code>: Configures the <strong>Access-Control-Max-Age</strong> CORS header. Set to an integer to pass the header, otherwise it is omitted.</li>
<li><code>preflightContinue</code>: Pass the CORS preflight response to the next handler.</li>
<li><code>optionsSuccessStatus</code>: Provides a status code to use for successful <code>OPTIONS</code> requests, since some legacy browsers (IE11, various SmartTVs) choke on <code>204</code>.</li>
</ul>
<p>The default configuration is the equivalent of:</p>
<pre><code class="json">{
  <span class="hljs-attr">"origin"</span>: <span class="hljs-string">"*"</span>,
  <span class="hljs-attr">"methods"</span>: <span class="hljs-string">"GET,HEAD,PUT,PATCH,POST,DELETE"</span>,
  <span class="hljs-attr">"preflightContinue"</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">"optionsSuccessStatus"</span>: <span class="hljs-number">204</span>
}
</code></pre>
<p>For details on the effect of each CORS header, read <a href="http://www.html5rocks.com/en/tutorials/cors/">this</a> article on HTML5 Rocks.</p>
<div class="pilwrap" id="demo">
  <h2>
    <a href="#demo" name="demo" class="pilcrow"></a>
Demo
  </h2>
</div>
<p>A demo that illustrates CORS working (and not working) using jQuery is available here: <a href="http://node-cors-client.herokuapp.com/">http://node-cors-client.herokuapp.com/</a></p>
<p>Code for that demo can be found here:</p>
<ul>
<li>Client: <a href="https://github.com/TroyGoode/node-cors-client">https://github.com/TroyGoode/node-cors-client</a></li>
<li>Server: <a href="https://github.com/TroyGoode/node-cors-server">https://github.com/TroyGoode/node-cors-server</a></li>
</ul>
<div class="pilwrap" id="license">
  <h2>
    <a href="#license" name="license" class="pilcrow"></a>
License
  </h2>
</div>
<p><a href="http://www.opensource.org/licenses/mit-license.php">MIT License</a></p>
<div class="pilwrap" id="author">
  <h2>
    <a href="#author" name="author" class="pilcrow"></a>
Author
  </h2>
</div>
<p><a href="https://github.com/TroyGoode">Troy Goode</a> (<a href="mailto:troygoode@gmail.com.html">troygoode@gmail.com</a>)</p>
</div>
  </div>
</body>
</html>
