<!DOCTYPE html>
<html>
<head>
  <title>readme.md</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules\\apollo-upload-server\\readme.md";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#apollo-upload-server">apollo-upload-server</a>
      </div>

      <div class="heading h2">
        <a href="#setup">Setup</a>
      </div>

      <div class="heading h3">
        <a href="#options">Options</a>
      </div>

      <div class="heading h3">
        <a href="#koa">Koa</a>
      </div>

      <div class="heading h3">
        <a href="#express">Express</a>
      </div>

      <div class="heading h3">
        <a href="#custom-middleware">Custom middleware</a>
      </div>

      <div class="heading h3">
        <a href="#upload-scalar">Upload scalar</a>
      </div>

      <div class="heading h2">
        <a href="#usage">Usage</a>
      </div>

      <div class="heading h2">
        <a href="#support">Support</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="docs markdown"><p><img src="https://cdn.rawgit.com/jaydenseric/apollo-upload-server/6831fef/apollo-upload-logo.svg" alt="Apollo upload logo"></p>
<div class="pilwrap" id="apollo-upload-server">
  <h1>
    <a href="#apollo-upload-server" name="apollo-upload-server" class="pilcrow"></a>
apollo-upload-server
  </h1>
</div>
<p><a href="https://npm.im/apollo-upload-server"><img src="https://img.shields.io/npm/v/apollo-upload-server.svg" alt="npm version"></a> <img src="https://img.shields.io/npm/l/apollo-upload-server.svg" alt="Licence"> <a href="https://github.com/jaydenseric/apollo-upload-server/issues"><img src="https://img.shields.io/github/issues/jaydenseric/apollo-upload-server.svg" alt="Github issues"></a> <a href="https://github.com/jaydenseric/apollo-upload-server/stargazers"><img src="https://img.shields.io/github/stars/jaydenseric/apollo-upload-server.svg" alt="Github stars"></a> <a href="https://travis-ci.org/jaydenseric/apollo-upload-server"><img src="https://img.shields.io/travis/jaydenseric/apollo-upload-server.svg" alt="Travis status"></a></p>
<p>Enhances <a href="https://apollographql.com">Apollo</a> for intuitive file uploads via GraphQL queries or mutations. Use with a <a href="https://github.com/jaydenseric/graphql-multipart-request-spec#client">GraphQL multipart request spec client implementation</a> such as <a href="https://github.com/jaydenseric/apollo-upload-client">apollo-upload-client</a>.</p>
<div class="pilwrap" id="setup">
  <h2>
    <a href="#setup" name="setup" class="pilcrow"></a>
Setup
  </h2>
</div>
<p>Install with peer dependencies using <a href="https://www.npmjs.com">npm</a>:</p>
<pre><code class="shell">npm install apollo-upload-server graphql
</code></pre>
<p>Add the middleware just before <a href="https://github.com/apollographql/graphql-server">graphql-server</a>.</p>
<div class="pilwrap" id="options">
  <h3>
    <a href="#options" name="options" class="pilcrow"></a>
Options
  </h3>
</div>
<ul>
<li><code>maxFieldSize</code> (integer): Max allowed non-file multipart form field size in bytes; enough for your queries (default: 1 MB).</li>
<li><code>maxFileSize</code> (integer): Max allowed file size in bytes (default: Infinity).</li>
<li><code>maxFiles</code> (integer): Max allowed number of files (default: Infinity).</li>
</ul>
<div class="pilwrap" id="koa">
  <h3>
    <a href="#koa" name="koa" class="pilcrow"></a>
<a href="http://koajs.com">Koa</a>
  </h3>
</div>
<pre><code class="js"><span class="hljs-keyword">import</span> { apolloUploadKoa } <span class="hljs-keyword">from</span> <span class="hljs-string">'apollo-upload-server'</span>

<span class="hljs-comment">// …</span>

router.post(
  <span class="hljs-string">'/graphql'</span>,
  koaBody(),
  apolloUploadKoa(<span class="hljs-comment">/* Options */</span>),
  graphqlKoa(<span class="hljs-comment">/* … */</span>)
)
</code></pre>
<div class="pilwrap" id="express">
  <h3>
    <a href="#express" name="express" class="pilcrow"></a>
<a href="http://expressjs.com">Express</a>
  </h3>
</div>
<pre><code class="js"><span class="hljs-keyword">import</span> { apolloUploadExpress } <span class="hljs-keyword">from</span> <span class="hljs-string">'apollo-upload-server'</span>

<span class="hljs-comment">// …</span>

app.use(
  <span class="hljs-string">'/graphql'</span>,
  bodyParser.json(),
  apolloUploadExpress(<span class="hljs-comment">/* Options */</span>),
  graphqlExpress(<span class="hljs-comment">/* … */</span>)
)
</code></pre>
<div class="pilwrap" id="custom-middleware">
  <h3>
    <a href="#custom-middleware" name="custom-middleware" class="pilcrow"></a>
Custom middleware
  </h3>
</div>
<p>Middleware wraps the async function <code>processRequest</code> which accepts a Node.js request and an optional <a href="#options.html">options object</a> as arguments. It returns a promise that resolves an operations object for a GraphQL server to consume (usually as the request body). Import it to create custom middleware:</p>
<pre><code class="js"><span class="hljs-keyword">import</span> { processRequest } <span class="hljs-keyword">from</span> <span class="hljs-string">'apollo-upload-server'</span>
</code></pre>
<div class="pilwrap" id="upload-scalar">
  <h3>
    <a href="#upload-scalar" name="upload-scalar" class="pilcrow"></a>
<code>Upload</code> scalar
  </h3>
</div>
<p>A file upload promise that resolves an object containing:</p>
<ul>
<li><code>stream</code></li>
<li><code>filename</code></li>
<li><code>mimetype</code></li>
<li><code>encoding</code></li>
</ul>
<p>It must be added to your types and resolvers:</p>
<pre><code class="js"><span class="hljs-keyword">import</span> { makeExecutableSchema } <span class="hljs-keyword">from</span> <span class="hljs-string">'graphql-tools'</span>
<span class="hljs-keyword">import</span> { GraphQLUpload } <span class="hljs-keyword">from</span> <span class="hljs-string">'apollo-upload-server'</span>

<span class="hljs-keyword">const</span> schema = makeExecutableSchema({
  <span class="hljs-attr">typeDefs</span>: <span class="hljs-string">`scalar Upload`</span>,
  <span class="hljs-attr">resolvers</span>: { <span class="hljs-attr">Upload</span>: GraphQLUpload }
})
</code></pre>
<div class="pilwrap" id="usage">
  <h2>
    <a href="#usage" name="usage" class="pilcrow"></a>
Usage
  </h2>
</div>
<p>Files uploaded via a <a href="https://github.com/jaydenseric/graphql-multipart-request-spec">GraphQL multipart request</a> appear as <a href="#upload-scalar.html"><code>Upload</code> scalars</a> in resolver arguments. The upload streams can be used to store the files in the local filesystem or in the cloud. See also <a href="https://github.com/jaydenseric/apollo-upload-client#usage">apollo-upload-client usage</a> and the <a href="https://github.com/jaydenseric/apollo-upload-examples">example API and client</a>.</p>
<div class="pilwrap" id="support">
  <h2>
    <a href="#support" name="support" class="pilcrow"></a>
Support
  </h2>
</div>
<ul>
<li>Node.js v6.10+, see <code>package.json</code> <code>engines</code>.</li>
</ul>
</div>
  </div>
</body>
</html>
