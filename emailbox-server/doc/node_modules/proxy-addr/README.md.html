<!DOCTYPE html>
<html>
<head>
  <title>README.md</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules\\proxy-addr\\README.md";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#proxy-addr">proxy-addr</a>
      </div>

      <div class="heading h2">
        <a href="#install">Install</a>
      </div>

      <div class="heading h2">
        <a href="#api">API</a>
      </div>

      <div class="heading h3">
        <a href="#proxyaddr-req-trust">proxyaddr(req, trust)</a>
      </div>

      <div class="heading h3">
        <a href="#proxyaddr.all-req-trust">proxyaddr.all(req, [trust])</a>
      </div>

      <div class="heading h3">
        <a href="#proxyaddr.compile-val">proxyaddr.compile(val)</a>
      </div>

      <div class="heading h2">
        <a href="#testing">Testing</a>
      </div>

      <div class="heading h2">
        <a href="#benchmarks">Benchmarks</a>
      </div>

      <div class="heading h2">
        <a href="#license">License</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="docs markdown"><div class="pilwrap" id="proxy-addr">
  <h1>
    <a href="#proxy-addr" name="proxy-addr" class="pilcrow"></a>
proxy-addr
  </h1>
</div>
<p><a href="https://npmjs.org/package/proxy-addr"><img src="https://img.shields.io/npm/v/proxy-addr.svg" alt="NPM Version"></a>
<a href="https://npmjs.org/package/proxy-addr"><img src="https://img.shields.io/npm/dm/proxy-addr.svg" alt="NPM Downloads"></a>
<a href="https://nodejs.org/en/download/"><img src="https://img.shields.io/node/v/proxy-addr.svg" alt="Node.js Version"></a>
<a href="https://travis-ci.org/jshttp/proxy-addr"><img src="https://img.shields.io/travis/jshttp/proxy-addr/master.svg" alt="Build Status"></a>
<a href="https://coveralls.io/r/jshttp/proxy-addr?branch=master"><img src="https://img.shields.io/coveralls/jshttp/proxy-addr/master.svg" alt="Test Coverage"></a></p>
<p>Determine address of proxied request</p>
<div class="pilwrap" id="install">
  <h2>
    <a href="#install" name="install" class="pilcrow"></a>
Install
  </h2>
</div>
<p>This is a <a href="https://nodejs.org/en/">Node.js</a> module available through the
<a href="https://www.npmjs.com/">npm registry</a>. Installation is done using the
<a href="https://docs.npmjs.com/getting-started/installing-npm-packages-locally"><code>npm install</code> command</a>:</p>
<pre><code class="sh">$ npm install proxy-addr
</code></pre>
<div class="pilwrap" id="api">
  <h2>
    <a href="#api" name="api" class="pilcrow"></a>
API
  </h2>
</div>
<!-- eslint-disable no-unused-vars -->
<pre><code class="js"><span class="hljs-keyword">var</span> proxyaddr = <span class="hljs-built_in">require</span>(<span class="hljs-string">'proxy-addr'</span>)
</code></pre>
<div class="pilwrap" id="proxyaddr-req-trust">
  <h3>
    <a href="#proxyaddr-req-trust" name="proxyaddr-req-trust" class="pilcrow"></a>
proxyaddr(req, trust)
  </h3>
</div>
<p>Return the address of the request, using the given <code>trust</code> parameter.</p>
<p>The <code>trust</code> argument is a function that returns <code>true</code> if you trust
the address, <code>false</code> if you don't. The closest untrusted address is
returned.</p>
<!-- eslint-disable no-undef -->
<pre><code class="js">proxyaddr(req, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">addr</span>) </span>{ <span class="hljs-keyword">return</span> addr === <span class="hljs-string">'127.0.0.1'</span> })
proxyaddr(req, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">addr, i</span>) </span>{ <span class="hljs-keyword">return</span> i &lt; <span class="hljs-number">1</span> })
</code></pre>
<p>The <code>trust</code> arugment may also be a single IP address string or an
array of trusted addresses, as plain IP addresses, CIDR-formatted
strings, or IP/netmask strings.</p>
<!-- eslint-disable no-undef -->
<pre><code class="js">proxyaddr(req, <span class="hljs-string">'127.0.0.1'</span>)
proxyaddr(req, [<span class="hljs-string">'127.0.0.0/8'</span>, <span class="hljs-string">'10.0.0.0/8'</span>])
proxyaddr(req, [<span class="hljs-string">'127.0.0.0/255.0.0.0'</span>, <span class="hljs-string">'192.168.0.0/255.255.0.0'</span>])
</code></pre>
<p>This module also supports IPv6. Your IPv6 addresses will be normalized
automatically (i.e. <code>fe80::00ed:1</code> equals <code>fe80:0:0:0:0:0:ed:1</code>).</p>
<!-- eslint-disable no-undef -->
<pre><code class="js">proxyaddr(req, <span class="hljs-string">'::1'</span>)
proxyaddr(req, [<span class="hljs-string">'::1/128'</span>, <span class="hljs-string">'fe80::/10'</span>])
</code></pre>
<p>This module will automatically work with IPv4-mapped IPv6 addresses
as well to support node.js in IPv6-only mode. This means that you do
not have to specify both <code>::ffff:a00:1</code> and <code>10.0.0.1</code>.</p>
<p>As a convenience, this module also takes certain pre-defined names
in addition to IP addresses, which expand into IP addresses:</p>
<!-- eslint-disable no-undef -->
<pre><code class="js">proxyaddr(req, <span class="hljs-string">'loopback'</span>)
proxyaddr(req, [<span class="hljs-string">'loopback'</span>, <span class="hljs-string">'fc00:ac:1ab5:fff::1/64'</span>])
</code></pre>
<ul>
<li><code>loopback</code>: IPv4 and IPv6 loopback addresses (like <code>::1</code> and
<code>127.0.0.1</code>).</li>
<li><code>linklocal</code>: IPv4 and IPv6 link-local addresses (like
<code>fe80::1:1:1:1</code> and <code>169.254.0.1</code>).</li>
<li><code>uniquelocal</code>: IPv4 private addresses and IPv6 unique-local
addresses (like <code>fc00:ac:1ab5:fff::1</code> and <code>192.168.0.1</code>).</li>
</ul>
<p>When <code>trust</code> is specified as a function, it will be called for each
address to determine if it is a trusted address. The function is
given two arguments: <code>addr</code> and <code>i</code>, where <code>addr</code> is a string of
the address to check and <code>i</code> is a number that represents the distance
from the socket address.</p>
<div class="pilwrap" id="proxyaddr.all-req-trust">
  <h3>
    <a href="#proxyaddr.all-req-trust" name="proxyaddr.all-req-trust" class="pilcrow"></a>
proxyaddr.all(req, [trust])
  </h3>
</div>
<p>Return all the addresses of the request, optionally stopping at the
first untrusted. This array is ordered from closest to furthest
(i.e. <code>arr[0] === req.connection.remoteAddress</code>).</p>
<!-- eslint-disable no-undef -->
<pre><code class="js">proxyaddr.all(req)
</code></pre>
<p>The optional <code>trust</code> argument takes the same arguments as <code>trust</code>
does in <code>proxyaddr(req, trust)</code>.</p>
<!-- eslint-disable no-undef -->
<pre><code class="js">proxyaddr.all(req, <span class="hljs-string">'loopback'</span>)
</code></pre>
<div class="pilwrap" id="proxyaddr.compile-val">
  <h3>
    <a href="#proxyaddr.compile-val" name="proxyaddr.compile-val" class="pilcrow"></a>
proxyaddr.compile(val)
  </h3>
</div>
<p>Compiles argument <code>val</code> into a <code>trust</code> function. This function takes
the same arguments as <code>trust</code> does in <code>proxyaddr(req, trust)</code> and
returns a function suitable for <code>proxyaddr(req, trust)</code>.</p>
<!-- eslint-disable no-undef, no-unused-vars -->
<pre><code class="js"><span class="hljs-keyword">var</span> trust = proxyaddr.compile(<span class="hljs-string">'loopback'</span>)
<span class="hljs-keyword">var</span> addr = proxyaddr(req, trust)
</code></pre>
<p>This function is meant to be optimized for use against every request.
It is recommend to compile a trust function up-front for the trusted
configuration and pass that to <code>proxyaddr(req, trust)</code> for each request.</p>
<div class="pilwrap" id="testing">
  <h2>
    <a href="#testing" name="testing" class="pilcrow"></a>
Testing
  </h2>
</div>
<pre><code class="sh">$ npm <span class="hljs-built_in">test</span>
</code></pre>
<div class="pilwrap" id="benchmarks">
  <h2>
    <a href="#benchmarks" name="benchmarks" class="pilcrow"></a>
Benchmarks
  </h2>
</div>
<pre><code class="sh">$ npm run-script bench
</code></pre>
<div class="pilwrap" id="license">
  <h2>
    <a href="#license" name="license" class="pilcrow"></a>
License
  </h2>
</div>
<p><a href="LICENSE.html">MIT</a></p>
</div>
  </div>
</body>
</html>
