<!DOCTYPE html>
<html>
<head>
  <title>index.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules\\range-parser\\index.js";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>index.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>
<div class="dox">
<div class="summary">
<p>!
range-parser
Copyright(c) 2012-2014 TJ Holowaychuk
Copyright(c) 2015-2016 Douglas Christopher Wilson
MIT Licensed</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-meta">
'use strict'</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<div class="dox">
<div class="summary">
<p>Module exports.</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-built_in">module</span>.exports = rangeParser

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<div class="dox">
<div class="summary">
<p>Parse &quot;Range&quot; header <code>str</code> relative to the given file <code>size</code>.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">size</span>
<span class="dox_type">Number</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">str</span>
<span class="dox_type">String</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">[options]</span>
<span class="dox_type">Object</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">Array</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rangeParser</span> (<span class="hljs-params">size, str, options</span>) </span>{
  <span class="hljs-keyword">var</span> index = str.indexOf(<span class="hljs-string">'='</span>)

  <span class="hljs-keyword">if</span> (index === <span class="hljs-number">-1</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-number">-2</span>
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>split the range string</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> arr = str.slice(index + <span class="hljs-number">1</span>).split(<span class="hljs-string">','</span>)
  <span class="hljs-keyword">var</span> ranges = []

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>add ranges type</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  ranges.type = str.slice(<span class="hljs-number">0</span>, index)

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>parse all ranges</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++) {
    <span class="hljs-keyword">var</span> range = arr[i].split(<span class="hljs-string">'-'</span>)
    <span class="hljs-keyword">var</span> start = <span class="hljs-built_in">parseInt</span>(range[<span class="hljs-number">0</span>], <span class="hljs-number">10</span>)
    <span class="hljs-keyword">var</span> end = <span class="hljs-built_in">parseInt</span>(range[<span class="hljs-number">1</span>], <span class="hljs-number">10</span>)

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>-nnn</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isNaN</span>(start)) {
      start = size - end
      end = size - <span class="hljs-number">1</span>
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>nnn-</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isNaN</span>(end)) {
      end = size - <span class="hljs-number">1</span>
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>limit last-byte-pos to current length</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">if</span> (end &gt; size - <span class="hljs-number">1</span>) {
      end = size - <span class="hljs-number">1</span>
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>invalid or unsatisifiable</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isNaN</span>(start) || <span class="hljs-built_in">isNaN</span>(end) || start &gt; end || start &lt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">continue</span>
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>add range</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    ranges.push({
      <span class="hljs-attr">start</span>: start,
      <span class="hljs-attr">end</span>: end
    })
  }

  <span class="hljs-keyword">if</span> (ranges.length &lt; <span class="hljs-number">1</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<p>unsatisifiable</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>
  }

  <span class="hljs-keyword">return</span> options &amp;&amp; options.combine
    ? combineRanges(ranges)
    : ranges
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<div class="dox">
<div class="summary">
<p>Combine overlapping &amp; adjacent ranges.</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">combineRanges</span> (<span class="hljs-params">ranges</span>) </span>{
  <span class="hljs-keyword">var</span> ordered = ranges.map(mapWithIndex).sort(sortByRangeStart)

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>, i = <span class="hljs-number">1</span>; i &lt; ordered.length; i++) {
    <span class="hljs-keyword">var</span> range = ordered[i]
    <span class="hljs-keyword">var</span> current = ordered[j]

    <span class="hljs-keyword">if</span> (range.start &gt; current.end + <span class="hljs-number">1</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<p>next range</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      ordered[++j] = range
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (range.end &gt; current.end) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<p>extend range</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      current.end = range.end
      current.index = <span class="hljs-built_in">Math</span>.min(current.index, range.index)
    }
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<p>trim ordered array</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  ordered.length = j + <span class="hljs-number">1</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<p>generate combined range</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> combined = ordered.sort(sortByRangeIndex).map(mapWithoutIndex)

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18"></a>
</div>
<p>copy ranges type</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  combined.type = ranges.type

  <span class="hljs-keyword">return</span> combined
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<div class="dox">
<div class="summary">
<p>Map function to add index value to ranges.</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mapWithIndex</span> (<span class="hljs-params">range, index</span>) </span>{
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">start</span>: range.start,
    <span class="hljs-attr">end</span>: range.end,
    <span class="hljs-attr">index</span>: index
  }
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20"></a>
</div>
<div class="dox">
<div class="summary">
<p>Map function to remove index value from ranges.</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mapWithoutIndex</span> (<span class="hljs-params">range</span>) </span>{
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">start</span>: range.start,
    <span class="hljs-attr">end</span>: range.end
  }
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21"></a>
</div>
<div class="dox">
<div class="summary">
<p>Sort function to sort ranges by index.</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sortByRangeIndex</span> (<span class="hljs-params">a, b</span>) </span>{
  <span class="hljs-keyword">return</span> a.index - b.index
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22"></a>
</div>
<div class="dox">
<div class="summary">
<p>Sort function to sort ranges by start position.</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sortByRangeStart</span> (<span class="hljs-params">a, b</span>) </span>{
  <span class="hljs-keyword">return</span> a.start - b.start
}

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
