<!DOCTYPE html>
<html>
<head>
  <title>punycode.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules\\punycode\\punycode.js";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>punycode.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-comment">/*! https://mths.be/punycode v1.3.2 by @mathias */</span>
;(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">root</span>) </span>{

	<span class="hljs-comment">/** Detect free variables */</span>
	<span class="hljs-keyword">var</span> freeExports = <span class="hljs-keyword">typeof</span> exports == <span class="hljs-string">'object'</span> &amp;&amp; exports &amp;&amp;
		!exports.nodeType &amp;&amp; exports;
	<span class="hljs-keyword">var</span> freeModule = <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">module</span> == <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-built_in">module</span> &amp;&amp;
		!<span class="hljs-built_in">module</span>.nodeType &amp;&amp; <span class="hljs-built_in">module</span>;
	<span class="hljs-keyword">var</span> freeGlobal = <span class="hljs-keyword">typeof</span> global == <span class="hljs-string">'object'</span> &amp;&amp; global;
	<span class="hljs-keyword">if</span> (
		freeGlobal.global === freeGlobal ||
		freeGlobal.window === freeGlobal ||
		freeGlobal.self === freeGlobal
	) {
		root = freeGlobal;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<div class="dox">
<div class="summary">
<p>The <code>punycode</code> object.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Type</div>
<div class="dox_tag_detail">
<span class="dox_type">bjec</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-keyword">var</span> punycode,

	<span class="hljs-comment">/** Highest positive signed 32-bit float value */</span>
	maxInt = <span class="hljs-number">2147483647</span>, <span class="hljs-comment">// aka. 0x7FFFFFFF or 2^31-1</span>

	<span class="hljs-comment">/** Bootstring parameters */</span>
	base = <span class="hljs-number">36</span>,
	tMin = <span class="hljs-number">1</span>,
	tMax = <span class="hljs-number">26</span>,
	skew = <span class="hljs-number">38</span>,
	damp = <span class="hljs-number">700</span>,
	initialBias = <span class="hljs-number">72</span>,
	initialN = <span class="hljs-number">128</span>, <span class="hljs-comment">// 0x80</span>
	delimiter = <span class="hljs-string">'-'</span>, <span class="hljs-comment">// '\x2D'</span>

	<span class="hljs-comment">/** Regular expressions */</span>
	regexPunycode = <span class="hljs-regexp">/^xn--/</span>,
	regexNonASCII = <span class="hljs-regexp">/[^\x20-\x7E]/</span>, <span class="hljs-comment">// unprintable ASCII chars + non-ASCII chars</span>
	regexSeparators = <span class="hljs-regexp">/[\x2E\u3002\uFF0E\uFF61]/g</span>, <span class="hljs-comment">// RFC 3490 separators</span>

	<span class="hljs-comment">/** Error messages */</span>
	errors = {
		<span class="hljs-string">'overflow'</span>: <span class="hljs-string">'Overflow: input needs wider integers to process'</span>,
		<span class="hljs-string">'not-basic'</span>: <span class="hljs-string">'Illegal input &gt;= 0x80 (not a basic code point)'</span>,
		<span class="hljs-string">'invalid-input'</span>: <span class="hljs-string">'Invalid input'</span>
	},

	<span class="hljs-comment">/** Convenience shortcuts */</span>
	baseMinusTMin = base - tMin,
	floor = <span class="hljs-built_in">Math</span>.floor,
	stringFromCharCode = <span class="hljs-built_in">String</span>.fromCharCode,

	<span class="hljs-comment">/** Temporary variable */</span>
	key;

	<span class="hljs-comment">/*--------------------------------------------------------------------------*/</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<div class="dox">
<div class="summary">
<p>A generic error utility function.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">type</span>
<span class="dox_type">String</span>
<span>The error type.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">error</span>(<span class="hljs-params">type</span>) </span>{
		<span class="hljs-keyword">throw</span> <span class="hljs-built_in">RangeError</span>(errors[type]);
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<div class="dox">
<div class="summary">
<p>A generic <code>Array#map</code> utility function.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">array</span>
<span class="dox_type">Array</span>
<span>The array to iterate over.
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">callback</span>
<span class="dox_type">Function</span>
<span>The function that gets called for every array item.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">map</span>(<span class="hljs-params">array, fn</span>) </span>{
		<span class="hljs-keyword">var</span> length = array.length;
		<span class="hljs-keyword">var</span> result = [];
		<span class="hljs-keyword">while</span> (length--) {
			result[length] = fn(array[length]);
		}
		<span class="hljs-keyword">return</span> result;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<div class="dox">
<div class="summary">
<p>A simple <code>Array#map</code>-like wrapper to work with domain name strings or email
addresses.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">domain</span>
<span class="dox_type">String</span>
<span>The domain name or email address.
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">callback</span>
<span class="dox_type">Function</span>
<span>The function that gets called for every character.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mapDomain</span>(<span class="hljs-params">string, fn</span>) </span>{
		<span class="hljs-keyword">var</span> parts = string.split(<span class="hljs-string">'@'</span>);
		<span class="hljs-keyword">var</span> result = <span class="hljs-string">''</span>;
		<span class="hljs-keyword">if</span> (parts.length &gt; <span class="hljs-number">1</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>In email addresses, only the domain name should be punycoded. Leave
the local part (i.e. everything up to <code>@</code>) intact.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">			result = parts[<span class="hljs-number">0</span>] + <span class="hljs-string">'@'</span>;
			string = parts[<span class="hljs-number">1</span>];
		}
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>Avoid <code>split(regex)</code> for IE8 compatibility. See #17.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		string = string.replace(regexSeparators, <span class="hljs-string">'\x2E'</span>);
		<span class="hljs-keyword">var</span> labels = string.split(<span class="hljs-string">'.'</span>);
		<span class="hljs-keyword">var</span> encoded = map(labels, fn).join(<span class="hljs-string">'.'</span>);
		<span class="hljs-keyword">return</span> result + encoded;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<div class="dox">
<div class="summary">
<p>Creates an array containing the numeric code points of each Unicode
character in the string. While JavaScript uses UCS-2 internally,
this function will convert a pair of surrogate halves (each of which
UCS-2 exposes as separate characters) into a single code point,
matching UTF-16.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">See</div>
<div class="dox_tag_detail">
<span class="dox_type">`punycode.ucs2.encode`</span>
</div>
<div class="dox_tag_title">See</div>
<div class="dox_tag_detail">
<a href="&lt;https://mathiasbynens.be/notes/javascript-encoding&gt;">&lt;https://mathiasbynens.be/notes/javascript-encoding&gt;</a>
</div>
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">string</span>
<span class="dox_type">String</span>
<span>The Unicode input string (UCS-2).
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ucs2decode</span>(<span class="hljs-params">string</span>) </span>{
		<span class="hljs-keyword">var</span> output = [],
		    counter = <span class="hljs-number">0</span>,
		    length = string.length,
		    value,
		    extra;
		<span class="hljs-keyword">while</span> (counter &lt; length) {
			value = string.charCodeAt(counter++);
			<span class="hljs-keyword">if</span> (value &gt;= <span class="hljs-number">0xD800</span> &amp;&amp; value &lt;= <span class="hljs-number">0xDBFF</span> &amp;&amp; counter &lt; length) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>high surrogate, and there is a next character</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">				extra = string.charCodeAt(counter++);
				<span class="hljs-keyword">if</span> ((extra &amp; <span class="hljs-number">0xFC00</span>) == <span class="hljs-number">0xDC00</span>) { <span class="hljs-comment">// low surrogate</span>
					output.push(((value &amp; <span class="hljs-number">0x3FF</span>) &lt;&lt; <span class="hljs-number">10</span>) + (extra &amp; <span class="hljs-number">0x3FF</span>) + <span class="hljs-number">0x10000</span>);
				} <span class="hljs-keyword">else</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>unmatched surrogate; only append this code unit, in case the next
code unit is the high surrogate of a surrogate pair</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">					output.push(value);
					counter--;
				}
			} <span class="hljs-keyword">else</span> {
				output.push(value);
			}
		}
		<span class="hljs-keyword">return</span> output;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<div class="dox">
<div class="summary">
<p>Creates a string based on an array of numeric code points.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">See</div>
<div class="dox_tag_detail">
<span class="dox_type">`punycode.ucs2.decode`</span>
</div>
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">codePoints</span>
<span class="dox_type">Array</span>
<span>The array of numeric code points.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ucs2encode</span>(<span class="hljs-params">array</span>) </span>{
		<span class="hljs-keyword">return</span> map(array, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
			<span class="hljs-keyword">var</span> output = <span class="hljs-string">''</span>;
			<span class="hljs-keyword">if</span> (value &gt; <span class="hljs-number">0xFFFF</span>) {
				value -= <span class="hljs-number">0x10000</span>;
				output += stringFromCharCode(value &gt;&gt;&gt; <span class="hljs-number">10</span> &amp; <span class="hljs-number">0x3FF</span> | <span class="hljs-number">0xD800</span>);
				value = <span class="hljs-number">0xDC00</span> | value &amp; <span class="hljs-number">0x3FF</span>;
			}
			output += stringFromCharCode(value);
			<span class="hljs-keyword">return</span> output;
		}).join(<span class="hljs-string">''</span>);
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<div class="dox">
<div class="summary">
<p>Converts a basic code point into a digit/integer.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">See</div>
<div class="dox_tag_detail">
<span class="dox_type">`digitToBasic()`</span>
</div>
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">codePoint</span>
<span class="dox_type">Number</span>
<span>The basic numeric code point value.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">basicToDigit</span>(<span class="hljs-params">codePoint</span>) </span>{
		<span class="hljs-keyword">if</span> (codePoint - <span class="hljs-number">48</span> &lt; <span class="hljs-number">10</span>) {
			<span class="hljs-keyword">return</span> codePoint - <span class="hljs-number">22</span>;
		}
		<span class="hljs-keyword">if</span> (codePoint - <span class="hljs-number">65</span> &lt; <span class="hljs-number">26</span>) {
			<span class="hljs-keyword">return</span> codePoint - <span class="hljs-number">65</span>;
		}
		<span class="hljs-keyword">if</span> (codePoint - <span class="hljs-number">97</span> &lt; <span class="hljs-number">26</span>) {
			<span class="hljs-keyword">return</span> codePoint - <span class="hljs-number">97</span>;
		}
		<span class="hljs-keyword">return</span> base;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<div class="dox">
<div class="summary">
<p>Converts a digit/integer into a basic code point.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">See</div>
<div class="dox_tag_detail">
<span class="dox_type">`basicToDigit()`</span>
</div>
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">digit</span>
<span class="dox_type">Number</span>
<span>The numeric value of a basic code point.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">digitToBasic</span>(<span class="hljs-params">digit, flag</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<p>0..25 map to ASCII a..z or A..Z
26..35 map to ASCII 0..9</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		<span class="hljs-keyword">return</span> digit + <span class="hljs-number">22</span> + <span class="hljs-number">75</span> * (digit &lt; <span class="hljs-number">26</span>) - ((flag != <span class="hljs-number">0</span>) &lt;&lt; <span class="hljs-number">5</span>);
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<div class="dox">
<div class="summary">
<p>Bias adaptation function as per section 3.4 of RFC 3492.
http://tools.ietf.org/html/rfc3492#section-3.4</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">adapt</span>(<span class="hljs-params">delta, numPoints, firstTime</span>) </span>{
		<span class="hljs-keyword">var</span> k = <span class="hljs-number">0</span>;
		delta = firstTime ? floor(delta / damp) : delta &gt;&gt; <span class="hljs-number">1</span>;
		delta += floor(delta / numPoints);
		<span class="hljs-keyword">for</span> (<span class="hljs-comment">/* no initialization */</span>; delta &gt; baseMinusTMin * tMax &gt;&gt; <span class="hljs-number">1</span>; k += base) {
			delta = floor(delta / baseMinusTMin);
		}
		<span class="hljs-keyword">return</span> floor(k + (baseMinusTMin + <span class="hljs-number">1</span>) * delta / (delta + skew));
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<div class="dox">
<div class="summary">
<p>Converts a Punycode string of ASCII-only symbols to a string of Unicode
symbols.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">input</span>
<span class="dox_type">String</span>
<span>The Punycode string of ASCII-only symbols.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decode</span>(<span class="hljs-params">input</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<p>Don't use UCS-2</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		<span class="hljs-keyword">var</span> output = [],
		    inputLength = input.length,
		    out,
		    i = <span class="hljs-number">0</span>,
		    n = initialN,
		    bias = initialBias,
		    basic,
		    j,
		    index,
		    oldi,
		    w,
		    k,
		    digit,
		    t,
		    <span class="hljs-comment">/** Cached calculation results */</span>
		    baseMinusT;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18"></a>
</div>
<p>Handle the basic code points: let <code>basic</code> be the number of input code
points before the last delimiter, or <code>0</code> if there is none, then copy
the first basic code points to the output.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
		basic = input.lastIndexOf(delimiter);
		<span class="hljs-keyword">if</span> (basic &lt; <span class="hljs-number">0</span>) {
			basic = <span class="hljs-number">0</span>;
		}

		<span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; basic; ++j) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<p>if it's not a basic code point</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">			<span class="hljs-keyword">if</span> (input.charCodeAt(j) &gt;= <span class="hljs-number">0x80</span>) {
				error(<span class="hljs-string">'not-basic'</span>);
			}
			output.push(input.charCodeAt(j));
		}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20"></a>
</div>
<p>Main decoding loop: start just after the last delimiter if any basic code
points were copied; start at the beginning otherwise.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
		<span class="hljs-keyword">for</span> (index = basic &gt; <span class="hljs-number">0</span> ? basic + <span class="hljs-number">1</span> : <span class="hljs-number">0</span>; index &lt; inputLength; <span class="hljs-comment">/* no final expression */</span>) {

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21"></a>
</div>
<p><code>index</code> is the index of the next character to be consumed.
Decode a generalized variable-length integer into <code>delta</code>,
which gets added to <code>i</code>. The overflow checking is easier
if we increase <code>i</code> as we go, then subtract off its starting
value at the end to obtain <code>delta</code>.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">			<span class="hljs-keyword">for</span> (oldi = i, w = <span class="hljs-number">1</span>, k = base; <span class="hljs-comment">/* no condition */</span>; k += base) {

				<span class="hljs-keyword">if</span> (index &gt;= inputLength) {
					error(<span class="hljs-string">'invalid-input'</span>);
				}

				digit = basicToDigit(input.charCodeAt(index++));

				<span class="hljs-keyword">if</span> (digit &gt;= base || digit &gt; floor((maxInt - i) / w)) {
					error(<span class="hljs-string">'overflow'</span>);
				}

				i += digit * w;
				t = k &lt;= bias ? tMin : (k &gt;= bias + tMax ? tMax : k - bias);

				<span class="hljs-keyword">if</span> (digit &lt; t) {
					<span class="hljs-keyword">break</span>;
				}

				baseMinusT = base - t;
				<span class="hljs-keyword">if</span> (w &gt; floor(maxInt / baseMinusT)) {
					error(<span class="hljs-string">'overflow'</span>);
				}

				w *= baseMinusT;

			}

			out = output.length + <span class="hljs-number">1</span>;
			bias = adapt(i - oldi, out, oldi == <span class="hljs-number">0</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22"></a>
</div>
<p><code>i</code> was supposed to wrap around from <code>out</code> to <code>0</code>,
incrementing <code>n</code> each time, so we'll fix that now:</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">			<span class="hljs-keyword">if</span> (floor(i / out) &gt; maxInt - n) {
				error(<span class="hljs-string">'overflow'</span>);
			}

			n += floor(i / out);
			i %= out;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23"></a>
</div>
<p>Insert <code>n</code> at position <code>i</code> of the output</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">			output.splice(i++, <span class="hljs-number">0</span>, n);

		}

		<span class="hljs-keyword">return</span> ucs2encode(output);
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-24" id="section-24"></a>
</div>
<div class="dox">
<div class="summary">
<p>Converts a string of Unicode symbols (e.g. a domain name label) to a
Punycode string of ASCII-only symbols.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">input</span>
<span class="dox_type">String</span>
<span>The string of Unicode symbols.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encode</span>(<span class="hljs-params">input</span>) </span>{
		<span class="hljs-keyword">var</span> n,
		    delta,
		    handledCPCount,
		    basicLength,
		    bias,
		    j,
		    m,
		    q,
		    k,
		    t,
		    currentValue,
		    output = [],
		    <span class="hljs-comment">/** `inputLength` will hold the number of code points in `input`. */</span>
		    inputLength,
		    <span class="hljs-comment">/** Cached calculation results */</span>
		    handledCPCountPlusOne,
		    baseMinusT,
		    qMinusT;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-25" id="section-25"></a>
</div>
<p>Convert the input in UCS-2 to Unicode</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		input = ucs2decode(input);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26"></a>
</div>
<p>Cache the length</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		inputLength = input.length;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-27" id="section-27"></a>
</div>
<p>Initialize the state</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		n = initialN;
		delta = <span class="hljs-number">0</span>;
		bias = initialBias;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-28" id="section-28"></a>
</div>
<p>Handle the basic code points</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		<span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; inputLength; ++j) {
			currentValue = input[j];
			<span class="hljs-keyword">if</span> (currentValue &lt; <span class="hljs-number">0x80</span>) {
				output.push(stringFromCharCode(currentValue));
			}
		}

		handledCPCount = basicLength = output.length;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-29" id="section-29"></a>
</div>
<p><code>handledCPCount</code> is the number of code points that have been handled;
<code>basicLength</code> is the number of basic code points.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-30" id="section-30"></a>
</div>
<p>Finish the basic string - if it is not empty - with a delimiter</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		<span class="hljs-keyword">if</span> (basicLength) {
			output.push(delimiter);
		}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-31" id="section-31"></a>
</div>
<p>Main encoding loop:</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		<span class="hljs-keyword">while</span> (handledCPCount &lt; inputLength) {

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-32" id="section-32"></a>
</div>
<p>All non-basic code points &lt; n have been handled already. Find the next
larger one:</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">			<span class="hljs-keyword">for</span> (m = maxInt, j = <span class="hljs-number">0</span>; j &lt; inputLength; ++j) {
				currentValue = input[j];
				<span class="hljs-keyword">if</span> (currentValue &gt;= n &amp;&amp; currentValue &lt; m) {
					m = currentValue;
				}
			}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-33" id="section-33"></a>
</div>
<p>Increase <code>delta</code> enough to advance the decoder's &lt;n,i&gt; state to &lt;m,0&gt;,
but guard against overflow</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">			handledCPCountPlusOne = handledCPCount + <span class="hljs-number">1</span>;
			<span class="hljs-keyword">if</span> (m - n &gt; floor((maxInt - delta) / handledCPCountPlusOne)) {
				error(<span class="hljs-string">'overflow'</span>);
			}

			delta += (m - n) * handledCPCountPlusOne;
			n = m;

			<span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; inputLength; ++j) {
				currentValue = input[j];

				<span class="hljs-keyword">if</span> (currentValue &lt; n &amp;&amp; ++delta &gt; maxInt) {
					error(<span class="hljs-string">'overflow'</span>);
				}

				<span class="hljs-keyword">if</span> (currentValue == n) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-34" id="section-34"></a>
</div>
<p>Represent delta as a generalized variable-length integer</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">					<span class="hljs-keyword">for</span> (q = delta, k = base; <span class="hljs-comment">/* no condition */</span>; k += base) {
						t = k &lt;= bias ? tMin : (k &gt;= bias + tMax ? tMax : k - bias);
						<span class="hljs-keyword">if</span> (q &lt; t) {
							<span class="hljs-keyword">break</span>;
						}
						qMinusT = q - t;
						baseMinusT = base - t;
						output.push(
							stringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, <span class="hljs-number">0</span>))
						);
						q = floor(qMinusT / baseMinusT);
					}

					output.push(stringFromCharCode(digitToBasic(q, <span class="hljs-number">0</span>)));
					bias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);
					delta = <span class="hljs-number">0</span>;
					++handledCPCount;
				}
			}

			++delta;
			++n;

		}
		<span class="hljs-keyword">return</span> output.join(<span class="hljs-string">''</span>);
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-35" id="section-35"></a>
</div>
<div class="dox">
<div class="summary">
<p>Converts a Punycode string representing a domain name or an email address
to Unicode. Only the Punycoded parts of the input will be converted, i.e.
it doesn't matter if you call it on a string that has already been
converted to Unicode.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">input</span>
<span class="dox_type">String</span>
<span>The Punycoded domain name or email address to convert to Unicode.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toUnicode</span>(<span class="hljs-params">input</span>) </span>{
		<span class="hljs-keyword">return</span> mapDomain(input, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">string</span>) </span>{
			<span class="hljs-keyword">return</span> regexPunycode.test(string)
				? decode(string.slice(<span class="hljs-number">4</span>).toLowerCase())
				: string;
		});
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-36" id="section-36"></a>
</div>
<div class="dox">
<div class="summary">
<p>Converts a Unicode string representing a domain name or an email address to
Punycode. Only the non-ASCII parts of the domain name will be converted,
i.e. it doesn't matter if you call it with a domain that's already in
ASCII.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">input</span>
<span class="dox_type">String</span>
<span>The domain name or email address to convert, as a Unicode string.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toASCII</span>(<span class="hljs-params">input</span>) </span>{
		<span class="hljs-keyword">return</span> mapDomain(input, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">string</span>) </span>{
			<span class="hljs-keyword">return</span> regexNonASCII.test(string)
				? <span class="hljs-string">'xn--'</span> + encode(string)
				: string;
		});
	}

	<span class="hljs-comment">/*--------------------------------------------------------------------------*/</span>

	<span class="hljs-comment">/** Define the public API */</span>
	punycode = {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-37" id="section-37"></a>
</div>
<div class="dox">
<div class="summary">
<p>A string representing the current Punycode.js version number.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Type</div>
<div class="dox_tag_detail">
<span class="dox_type">trin</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">		<span class="hljs-string">'version'</span>: <span class="hljs-string">'1.3.2'</span>,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-38" id="section-38"></a>
</div>
<div class="dox">
<div class="summary">
<p>An object of methods to convert from JavaScript's internal character
representation (UCS-2) to Unicode code points, and back.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">See</div>
<div class="dox_tag_detail">
<a href="&lt;https://mathiasbynens.be/notes/javascript-encoding&gt;">&lt;https://mathiasbynens.be/notes/javascript-encoding&gt;</a>
</div>
<div class="dox_tag_title">Type</div>
<div class="dox_tag_detail">
<span class="dox_type">bjec</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">		<span class="hljs-string">'ucs2'</span>: {
			<span class="hljs-string">'decode'</span>: ucs2decode,
			<span class="hljs-string">'encode'</span>: ucs2encode
		},
		<span class="hljs-string">'decode'</span>: decode,
		<span class="hljs-string">'encode'</span>: encode,
		<span class="hljs-string">'toASCII'</span>: toASCII,
		<span class="hljs-string">'toUnicode'</span>: toUnicode
	};

	<span class="hljs-comment">/** Expose `punycode` */</span>
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-39" id="section-39"></a>
</div>
<p>Some AMD build optimizers, like r.js, check for specific condition patterns
like the following:</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-keyword">if</span> (
		<span class="hljs-keyword">typeof</span> define == <span class="hljs-string">'function'</span> &amp;&amp;
		<span class="hljs-keyword">typeof</span> define.amd == <span class="hljs-string">'object'</span> &amp;&amp;
		define.amd
	) {
		define(<span class="hljs-string">'punycode'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			<span class="hljs-keyword">return</span> punycode;
		});
	} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (freeExports &amp;&amp; freeModule) {
		<span class="hljs-keyword">if</span> (<span class="hljs-built_in">module</span>.exports == freeExports) { <span class="hljs-comment">// in Node.js or RingoJS v0.8.0+</span>
			freeModule.exports = punycode;
		} <span class="hljs-keyword">else</span> { <span class="hljs-comment">// in Narwhal or RingoJS v0.7.0-</span>
			<span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> punycode) {
				punycode.hasOwnProperty(key) &amp;&amp; (freeExports[key] = punycode[key]);
			}
		}
	} <span class="hljs-keyword">else</span> { <span class="hljs-comment">// in Rhino or a web browser</span>
		root.punycode = punycode;
	}

}(<span class="hljs-keyword">this</span>));

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
