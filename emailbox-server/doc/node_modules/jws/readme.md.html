<!DOCTYPE html>
<html>
<head>
  <title>readme.md</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules\\jws\\readme.md";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#node-jws">node-jws </a>
      </div>

      <div class="heading h1">
        <a href="#install">Install</a>
      </div>

      <div class="heading h1">
        <a href="#usage">Usage</a>
      </div>

      <div class="heading h2">
        <a href="#jws.algorithms">jws.ALGORITHMS</a>
      </div>

      <div class="heading h2">
        <a href="#jws.sign-options">jws.sign(options)</a>
      </div>

      <div class="heading h2">
        <a href="#jws.verify-signature-algorithm-secretorkey">jws.verify(signature, algorithm, secretOrKey)</a>
      </div>

      <div class="heading h2">
        <a href="#jws.decode-signature">jws.decode(signature)</a>
      </div>

      <div class="heading h2">
        <a href="#jws.createsign-options">jws.createSign(options)</a>
      </div>

      <div class="heading h2">
        <a href="#jws.createverify-options">jws.createVerify(options)</a>
      </div>

      <div class="heading h2">
        <a href="#class-signstream">Class: SignStream</a>
      </div>

      <div class="heading h3">
        <a href="#event-done">Event: &#39;done&#39;</a>
      </div>

      <div class="heading h3">
        <a href="#signer.payload">signer.payload</a>
      </div>

      <div class="heading h3">
        <a href="#signer.secretsigner.keysigner.privatekey">signer.secretsigner.keysigner.privateKey</a>
      </div>

      <div class="heading h2">
        <a href="#class-verifystream">Class: VerifyStream</a>
      </div>

      <div class="heading h3">
        <a href="#event-done-1">Event: &#39;done&#39;</a>
      </div>

      <div class="heading h3">
        <a href="#verifier.signature">verifier.signature</a>
      </div>

      <div class="heading h3">
        <a href="#verifier.secretverifier.keyverifier.publickey">verifier.secretverifier.keyverifier.publicKey</a>
      </div>

      <div class="heading h1">
        <a href="#todo">TODO</a>
      </div>

      <div class="heading h1">
        <a href="#license">License</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="docs markdown"><div class="pilwrap" id="node-jws">
  <h1>
    <a href="#node-jws" name="node-jws" class="pilcrow"></a>
node-jws <a href="http://travis-ci.org/brianloveswords/node-jws"><img src="https://secure.travis-ci.org/brianloveswords/node-jws.png" alt="Build Status"></a>
  </h1>
</div>
<p>An implementation of <a href="http://self-issued.info/docs/draft-ietf-jose-json-web-signature.html">JSON Web Signatures</a>.</p>
<p>This was developed against <code>draft-ietf-jose-json-web-signature-08</code> and
implements the entire spec <strong>except</strong> X.509 Certificate Chain
signing/verifying (patches welcome).</p>
<p>There are both syncronous (<code>jws.sign</code>, <code>jws.verify</code>) and streaming
(<code>jws.createSign</code>, <code>jws.createVerify</code>) APIs.</p>
<div class="pilwrap" id="install">
  <h1>
    <a href="#install" name="install" class="pilcrow"></a>
Install
  </h1>
</div>
<pre><code class="bash">$ npm install jws
</code></pre>
<div class="pilwrap" id="usage">
  <h1>
    <a href="#usage" name="usage" class="pilcrow"></a>
Usage
  </h1>
</div>
<div class="pilwrap" id="jws.algorithms">
  <h2>
    <a href="#jws.algorithms" name="jws.algorithms" class="pilcrow"></a>
jws.ALGORITHMS
  </h2>
</div>
<p>Array of supported algorithms. The following algorithms are currently supported.</p>
<table>
<thead>
<tr>
<th>alg Parameter Value</th>
<th>Digital Signature or MAC Algorithm</th>
</tr>
</thead>
<tbody>
<tr>
<td>HS256</td>
<td>HMAC using SHA-256 hash algorithm</td>
</tr>
<tr>
<td>HS384</td>
<td>HMAC using SHA-384 hash algorithm</td>
</tr>
<tr>
<td>HS512</td>
<td>HMAC using SHA-512 hash algorithm</td>
</tr>
<tr>
<td>RS256</td>
<td>RSASSA using SHA-256 hash algorithm</td>
</tr>
<tr>
<td>RS384</td>
<td>RSASSA using SHA-384 hash algorithm</td>
</tr>
<tr>
<td>RS512</td>
<td>RSASSA using SHA-512 hash algorithm</td>
</tr>
<tr>
<td>ES256</td>
<td>ECDSA using P-256 curve and SHA-256 hash algorithm</td>
</tr>
<tr>
<td>ES384</td>
<td>ECDSA using P-384 curve and SHA-384 hash algorithm</td>
</tr>
<tr>
<td>ES512</td>
<td>ECDSA using P-521 curve and SHA-512 hash algorithm</td>
</tr>
<tr>
<td>none</td>
<td>No digital signature or MAC value included</td>
</tr>
</tbody>
</table>
<div class="pilwrap" id="jws.sign-options">
  <h2>
    <a href="#jws.sign-options" name="jws.sign-options" class="pilcrow"></a>
jws.sign(options)
  </h2>
</div>
<p>(Synchronous) Return a JSON Web Signature for a header and a payload.</p>
<p>Options:</p>
<ul>
<li><code>header</code></li>
<li><code>payload</code></li>
<li><code>secret</code> or <code>privateKey</code></li>
<li><code>encoding</code> (Optional, defaults to 'utf8')</li>
</ul>
<p><code>header</code> must be an object with an <code>alg</code> property. <code>header.alg</code> must be
one a value found in <code>jws.ALGORITHMS</code>. See above for a table of
supported algorithms.</p>
<p>If <code>payload</code> is not a buffer or a string, it will be coerced into a string
using <code>JSON.stringify</code>.</p>
<p>Example</p>
<pre><code class="js"><span class="hljs-keyword">const</span> signature = jws.sign({
  <span class="hljs-attr">header</span>: { <span class="hljs-attr">alg</span>: <span class="hljs-string">'HS256'</span> },
  <span class="hljs-attr">payload</span>: <span class="hljs-string">'h. jon benjamin'</span>,
  <span class="hljs-attr">secret</span>: <span class="hljs-string">'has a van'</span>,
});
</code></pre>
<div class="pilwrap" id="jws.verify-signature-algorithm-secretorkey">
  <h2>
    <a href="#jws.verify-signature-algorithm-secretorkey" name="jws.verify-signature-algorithm-secretorkey" class="pilcrow"></a>
jws.verify(signature, algorithm, secretOrKey)
  </h2>
</div>
<p>(Synchronous) Returns<code>true</code> or <code>false</code> for whether a signature matches a
secret or key.</p>
<p><code>signature</code> is a JWS Signature. <code>header.alg</code> must be a value found in <code>jws.ALGORITHMS</code>.
See above for a table of supported algorithms. <code>secretOrKey</code> is a string or
buffer containing either the secret for HMAC algorithms, or the PEM
encoded public key for RSA and ECDSA.</p>
<p>Note that the <code>&quot;alg&quot;</code> value from the signature header is ignored.</p>
<div class="pilwrap" id="jws.decode-signature">
  <h2>
    <a href="#jws.decode-signature" name="jws.decode-signature" class="pilcrow"></a>
jws.decode(signature)
  </h2>
</div>
<p>(Synchronous) Returns the decoded header, decoded payload, and signature
parts of the JWS Signature.</p>
<p>Returns an object with three properties, e.g.</p>
<pre><code class="js">{ <span class="hljs-attr">header</span>: { <span class="hljs-attr">alg</span>: <span class="hljs-string">'HS256'</span> },
  <span class="hljs-attr">payload</span>: <span class="hljs-string">'h. jon benjamin'</span>,
  <span class="hljs-attr">signature</span>: <span class="hljs-string">'YOWPewyGHKu4Y_0M_vtlEnNlqmFOclqp4Hy6hVHfFT4'</span>
}
</code></pre>
<div class="pilwrap" id="jws.createsign-options">
  <h2>
    <a href="#jws.createsign-options" name="jws.createsign-options" class="pilcrow"></a>
jws.createSign(options)
  </h2>
</div>
<p>Returns a new SignStream object.</p>
<p>Options:</p>
<ul>
<li><code>header</code> (required)</li>
<li><code>payload</code></li>
<li><code>key</code> || <code>privateKey</code> || <code>secret</code></li>
<li><code>encoding</code> (Optional, defaults to 'utf8')</li>
</ul>
<p>Other than <code>header</code>, all options expect a string or a buffer when the
value is known ahead of time, or a stream for convenience.
<code>key</code>/<code>privateKey</code>/<code>secret</code> may also be an object when using an encrypted
private key, see the <a href="https://nodejs.org/api/crypto.html#crypto_sign_sign_private_key_output_format">crypto documentation</a>.</p>
<p>Example</p>
<pre><code class="js">
<span class="hljs-comment">// This...</span>
jws.createSign({
  <span class="hljs-attr">header</span>: { <span class="hljs-attr">alg</span>: <span class="hljs-string">'RS256'</span> },
  <span class="hljs-attr">privateKey</span>: privateKeyStream,
  <span class="hljs-attr">payload</span>: payloadStream,
}).on(<span class="hljs-string">'done'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">signature</span>) </span>{
  <span class="hljs-comment">// ...</span>
});

<span class="hljs-comment">// is equivilant to this:</span>
<span class="hljs-keyword">const</span> signer = jws.createSign({
  <span class="hljs-attr">header</span>: { <span class="hljs-attr">alg</span>: <span class="hljs-string">'RS256'</span> },
});
privateKeyStream.pipe(signer.privateKey);
payloadStream.pipe(signer.payload);
signer.on(<span class="hljs-string">'done'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">signature</span>) </span>{
  <span class="hljs-comment">// ...</span>
});
</code></pre>
<div class="pilwrap" id="jws.createverify-options">
  <h2>
    <a href="#jws.createverify-options" name="jws.createverify-options" class="pilcrow"></a>
jws.createVerify(options)
  </h2>
</div>
<p>Returns a new VerifyStream object.</p>
<p>Options:</p>
<ul>
<li><code>signature</code></li>
<li><code>algorithm</code></li>
<li><code>key</code> || <code>publicKey</code> || <code>secret</code></li>
<li><code>encoding</code> (Optional, defaults to 'utf8')</li>
</ul>
<p>All options expect a string or a buffer when the value is known ahead of
time, or a stream for convenience.</p>
<p>Example</p>
<pre><code class="js">
<span class="hljs-comment">// This...</span>
jws.createVerify({
  <span class="hljs-attr">publicKey</span>: pubKeyStream,
  <span class="hljs-attr">signature</span>: sigStream,
}).on(<span class="hljs-string">'done'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">verified, obj</span>) </span>{
  <span class="hljs-comment">// ...</span>
});

<span class="hljs-comment">// is equivilant to this:</span>
<span class="hljs-keyword">const</span> verifier = jws.createVerify();
pubKeyStream.pipe(verifier.publicKey);
sigStream.pipe(verifier.signature);
verifier.on(<span class="hljs-string">'done'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">verified, obj</span>) </span>{
  <span class="hljs-comment">// ...</span>
});
</code></pre>
<div class="pilwrap" id="class-signstream">
  <h2>
    <a href="#class-signstream" name="class-signstream" class="pilcrow"></a>
Class: SignStream
  </h2>
</div>
<p>A <code>Readable Stream</code> that emits a single data event, the calculated
signature, when done.</p>
<div class="pilwrap" id="event-done">
  <h3>
    <a href="#event-done" name="event-done" class="pilcrow"></a>
Event: 'done'
  </h3>
</div>
<p><code>function (signature) { }</code></p>
<div class="pilwrap" id="signer.payload">
  <h3>
    <a href="#signer.payload" name="signer.payload" class="pilcrow"></a>
signer.payload
  </h3>
</div>
<p>A <code>Writable Stream</code> that expects the JWS payload. Do <em>not</em> use if you
passed a <code>payload</code> option to the constructor.</p>
<p>Example</p>
<pre><code class="js">payloadStream.pipe(signer.payload);
</code></pre>
<div class="pilwrap" id="signer.secretsigner.keysigner.privatekey">
  <h3>
    <a href="#signer.secretsigner.keysigner.privatekey" name="signer.secretsigner.keysigner.privatekey" class="pilcrow"></a>
signer.secret<br>signer.key<br>signer.privateKey
  </h3>
</div>
<p>A <code>Writable Stream</code>. Expects the JWS secret for HMAC, or the privateKey
for ECDSA and RSA. Do <em>not</em> use if you passed a <code>secret</code> or <code>key</code> option
to the constructor.</p>
<p>Example:</p>
<pre><code class="js">privateKeyStream.pipe(signer.privateKey);
</code></pre>
<div class="pilwrap" id="class-verifystream">
  <h2>
    <a href="#class-verifystream" name="class-verifystream" class="pilcrow"></a>
Class: VerifyStream
  </h2>
</div>
<p>This is a <code>Readable Stream</code> that emits a single data event, the result
of whether or not that signature was valid.</p>
<div class="pilwrap" id="event-done-1">
  <h3>
    <a href="#event-done-1" name="event-done-1" class="pilcrow"></a>
Event: 'done'
  </h3>
</div>
<p><code>function (valid, obj) { }</code></p>
<p><code>valid</code> is a boolean for whether or not the signature is valid.</p>
<div class="pilwrap" id="verifier.signature">
  <h3>
    <a href="#verifier.signature" name="verifier.signature" class="pilcrow"></a>
verifier.signature
  </h3>
</div>
<p>A <code>Writable Stream</code> that expects a JWS Signature. Do <em>not</em> use if you
passed a <code>signature</code> option to the constructor.</p>
<div class="pilwrap" id="verifier.secretverifier.keyverifier.publickey">
  <h3>
    <a href="#verifier.secretverifier.keyverifier.publickey" name="verifier.secretverifier.keyverifier.publickey" class="pilcrow"></a>
verifier.secret<br>verifier.key<br>verifier.publicKey
  </h3>
</div>
<p>A <code>Writable Stream</code> that expects a public key or secret. Do <em>not</em> use if you
passed a <code>key</code> or <code>secret</code> option to the constructor.</p>
<div class="pilwrap" id="todo">
  <h1>
    <a href="#todo" name="todo" class="pilcrow"></a>
TODO
  </h1>
</div>
<ul>
<li>
<p>It feels like there should be some convenience options/APIs for
defining the algorithm rather than having to define a header object
with <code>{ alg: 'ES512' }</code> or whatever every time.</p>
</li>
<li>
<p>X.509 support, ugh</p>
</li>
</ul>
<div class="pilwrap" id="license">
  <h1>
    <a href="#license" name="license" class="pilcrow"></a>
License
  </h1>
</div>
<p>MIT</p>
<pre><code>Copyright (c) 2013-2015 Brian J. Brennan

Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the
&quot;Software&quot;), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be included
in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS
OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
</code></pre>
</div>
  </div>
</body>
</html>
